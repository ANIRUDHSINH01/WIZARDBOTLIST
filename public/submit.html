<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Submit Your Bot</title>
<style>
.profile-menu {
position: relative;
display: inline-block;
}
.profile-menu-content {
display: none;
position: absolute;
background-color: #f9f9f9;
min-width: 160px;
box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
z-index: 1;
}
.profile-menu:hover .profile-menu-content {
display: block;
}
.profile-menu-content a {
color: black;
padding: 12px 16px;
text-decoration: none;
display: block;
}
.profile-menu-content a:hover {background-color: #f1f1f1}
</style>
</head>
<body>
<h1>Submit Your Bot</h1>
<div class="profile-menu">
<img id="profile-photo" src="" alt="Profile Photo" width="50" height="50">
<span id="username"></span>
<div class="profile-menu-content">
<a href="/api/auth/logout">Logout</a>
</div>
</div>
<form id="submitForm">
<label for="botId">Bot ID:</label>
<input type="text" id="botId" name="botId" required>
<br>
<label for="ownerId">Owner ID:</label>
<input type="text" id="ownerId" name="ownerId" readonly>
<br>
<label for="ownerName">Owner Name:</label>
<input type="text" id="ownerName" name="ownerName" readonly>
<br>
<label for="botName">Bot Name:</label>
<input type="text" id="botName" name="botName" required>
<br>
<button type="submit">Submit</button>
</form>
<script>
document.addEventListener('DOMContentLoaded', () => {
fetch('/api/auth/userinfo')
.then(response => response.json())
.then(data => {
document.getElementById('profile-photo').src = `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png`;
document.getElementById('username').textContent = data.username;
document.getElementById('ownerId').value = data.id;
document.getElementById('ownerName').value = data.username;
})
.catch(error => console.error('Error fetching user info:', error));
});

document.getElementById('submitForm').addEventListener('submit', async (event) => {
event.preventDefault();
const botId = document.getElementById('botId').value;
const ownerId = document.getElementById('ownerId').value;
const ownerName = document.getElementById('ownerName').value;
const botName = document.getElementById('botName').value;

try {
const response = await fetch('/api/submit', {
method: 'POST',
headers: {
'Content-Type': 'application/json'
},
body: JSON.stringify({ botId, ownerId, ownerName, botName })
});
const result = await response.text();
alert(result);
} catch (error) {
console.error('Error submitting bot:', error);
}
});
</script>
</body>
</html>
